## Современные подходы в области сетевой кластеризации и блокмоделинга: систематизация и сравнительный анализ

### Введение

Цель настоящей главы и приведенного в ней аналитического обзора состоит в систематизации различных подходов в области сетевого кластеризации и блокмоделинга и  их сравнительном анализе для оценки эффективности применения при анализе динамических сетей (на примере сетей соавторства, изменяющихся во времени). Достижение этой цели требует решения следующих задач:

1. Рассмотреть особенности применения методологии блокмоделинга для анализа динамических сетей. 
2. Проанализировать детерминистический и стохастический подходы и разработанные в них модели  блокмоделинга, используемые для анализа динамических сетей. 
3. Сравнить модели блокмоделинга в рамках детерминистического и стохастического подходов, используемые для анализа динамических сетей. 
4. Проанализировать возможности применения блокмоделинга для изучения сетей соавторства в различных научных дисциплинах, в т.ч. в динамике.

В работе применялся сравнительный анализ и системный подход для проведения систематического обзора литературы в парадигме экспертной методологии, сформированной в рамках качественных исследований в области истории и социологии науки. Эта методология предполагает качественную стратегию экспертного отбора источников на основе анализа литературы по теме исследования, что позволяет преодолеть барьеры, связанные с усложнением, специализацией и фрагментацией научных направлений, рост публикационной активности исследователей, характерные для развития современной науки.  В качестве основы для сравнения различных подходов использовано моделирование методом Монте-Карло. 

В этой главе рассматриваются особенности использования методологии блокмоделинга для анализа динамических сетей, проблематика и актуальность которых показаны в части 1. Поскольку одной из основных особенностей анализа динамических сетей является проверка их устойчивости, там же приведены основные сведения о подходах к оценке устойчивости структуры блок-моделей (Rand Index, Рэнд-индекс). В части 2 представлены модели, разработанные на основе детерминированного и стохастического подходов к блокмоделированию для анализа динамических сетей.  В части 3 приведены основные результаты сравнения моделей с помощью имитационного моделирования методом Монте-Карло (метод симуляции), в т.ч. модели для исследования ненаправленных сетей в динамике. В части 5 анализируется использование блокмоделинга для изучения ненаправленных сетей соавторства во времени в различных научных дисциплинах.

### 1. Особенности применения блокмоделинга для анализа сетей в динамике (темпоральных сетей)
#### **Блокмоделинг как методология кластеризации сетевых данных**
Блокмоделинг — это группа методов кластеризации единиц и связей в сети. По определению Дориана и коллег [@batagelj1999], блокмоделинг используется для сведения больших, сложных, потенциально бессвязных сетевых структур к меньшим, понятным сетям, которые легче интерпретировать. Результатом блокмоделинга являются 1) кластеры эквивалентных единиц в сети и 2) связи внутри и между этими кластерами. Сжав или уменьшив большую сеть, получается сеть меньшего размера, которая называется блокмоделью. _Блокмодель_ — это сеть, в которой узлы образуют кластеры из исследуемой сети, которые также называются _позициями_ эквивалентных узлов. Другим результатом блокмоделинга является _матрица изображений_, которая представляет связи между и внутри полученных кластеров. Термин блок относится к части матрицы, которая показывает связи _между_ двумя кластерами или _внутри_ одного кластера. Диагональные блоки обозначают связи между единицами из одного кластера, а вне-диагональные — связи между единицами из разных кластеров.

Рассмотрим пример на Рис. 1, где представлена сеть узлов и связей между ними. Можно заметить, что узлы, окрашенные в синий цвет, имеют очень похожую структуру связей: они не связаны друг с другом, но все они связаны с узлами, окрашенными в красный цвет. Поскольку у них схожая структура связей, окрашенные в синий цвет узлы можно считать эквивалентными. То же самое относится и к узлам, окрашенным в красный цвет, которые также связаны друг с другом. Поскольку узлы синего и красного цветов имеют схожую структуру связей (или эквивалентны), их можно сжать в один узел, что показано на @fig:blockmodeling1 ниже под визуализацией сети. Из исходной сети мы получаем два новых узла, которые теперь являются кластерами узлов, представляющих их группы. Между этими двумя узлами имеются связи: одна из них соединяет красный и синий узлы, что означает, что эти две группы узлов связаны друг с другом, а также имеется петля, которая визуализирует тот факт, что узлы, окрашенные в красный цвет, тесно связаны между собой. 

Другой пример представляет собой взвешенную сеть (связям присвоены некоторые значения), визуализированную в матричном виде и в виде графа (@fig:blockmodeling2). Слева представлена исходная сеть в матричном виде и в виде графа. Применив процедуру блокмоделинга, мы получили _разбиение_ (partition). На основе этого разбиения мы можем упорядочить узлы таким образом, чтобы узлы, входящие в один кластер, располагались рядом друг с другом, а узлы из разных кластеров - отдельно (в середине). Различные кластеры разделены синими линиями; видно, что значения внутри каждого блока достаточно однородны по значениям силы связей. В исходной сети узлы окрашены в соответствии с решением блокмоделинга. Справа представлена полученная блокмодель: _матрица изображений_ и _граф изображений_, состоящий всего из трех узлов (кластеров); плотности блоков показаны в соответствующих ячейках этой матрицы. Наблюдается некая структура "ядро-периферия": ядро и две сплоченные группы, которые внутренне очень хорошо связаны друг с другом и с ядром.

![Пример 1: Эмпирические данные (вверху) и блок-модель (внизу) в виде графика](images/1_21_Maltseva_Network_clustering_and_blockmodeling.png){#fig:blockmodeling1}

![Пример 2: Эмпирические данные в матричном (вверху) и графическом (внизу) представлении.](images/2_21_Maltseva_Network_clustering_and_blockmodeling.png){#fig:blockmodeling2}

Два узла объединяются в одинаковые кластеры, если они эквивалентны. Существует несколько определений эквивалентности, наиболее известными из которых являются: 

1. Структурная эквивалентность [@lorrainfrancois1971], White and Reitz: 
   a) Две единицы структурно эквивалентны, если они одинаково связаны друг с другом и со всеми остальными единицами. 
   b) Две структурно эквивалентные единицы неразличимы, если удалить их лейблы. 
   c) Соответствующие идеальные блоки имеют либо все возможные связи (полные блоки), либо ни одной связи (нулевые блоки). 
   d) Наиболее часто используемая на практике эквивалентность. 

2. Регулярная эквивалентность(White and Reitz
   a) Регулярно эквивалентные единицы соединяются одинаковым образом с кластерами эквивалентных единиц. 
   b) Это определение очень близко к социологическому определению "социальной роли", однако оно редко встречается в эмпирических данных и (как показали исследования проблемы недостающих данных и устойчивости разбиений) весьма чувствительно к небольшим изменениям в сети. 
   c) Соответствующие идеальные блоки имеют хотя бы одну связь в каждой строке и столбце (регулярные блоки) или полностью пусты (нулевые блоки). 
   d) Регулярная эквивалентность является частным случаем структурной эквивалентности: если выполняется структурная эквивалентность, то выполняется и регулярная эквивалентность. 
   e) Также очень известна. 

3. Стохастическая эквивалентность Holland et al. 
   a) Две единицы статистически эквивалентны, если они имеют одинаковые вероятности связей со всеми другими единицами.

4. Обобщенная эквивалентность Doreian et al.
   a) Эквивалентность определяется набором допустимых типов блоков и, возможно, их расположением. 
   b) Обобщенный блокмоделинг очень удобен тем, что можно задавать различные типы блоков из множества возможных определенных типов блоков, а это уже косвенно определяет критериальную функцию.

Блокмоделинг - очень универсальный метод, который может быть использован для различных целей в сетевом анализе. Различные типы процедур блокмоделинга могут быть реализованы с помощью специально разработанного пакета "blockmodeling" на языке программирования R. Изначально пакет "blockmodeling" задумывался как реализация обобщенного блокмоделинга для взвешенных сетей. Кроме того, он позволяет вычислять меры сходства и несходства, основанные на структурной и регулярной эквивалентности (алгоритмы REGE), а также строить матрицы разбиения. Это пока единственное программное обеспечение, поддерживающее обобщенный блокмоделинг для взвешенных сетей. Недавно к его функционалу был добавлен анализ обобщенного блокмоделинга связных (например, многоуровневых) сетей.

#### Динамические сети
Термин "динамические сети" — это общий термин, который охватывает различные типы сетей (например, сети с временной меткой событий или моментальные «снимки»), включающие некоторую временную информацию. Подробное описание различных типов динамических сетей (или темпоральных) см. в работе [@holme2015a]. 

В работе мы сосредоточимся на сетях, которые измеряются в нескольких периодах времени, также называемых сетями в формате моментальных «снимков», или snapshot-сетями [@matias2017], [@ziberna2020]. Сети snapshot являются одной из разновидностей динамических сетей, в которых большинство узлов присутствуют во всех временных точках и измеряются одни и те же типы отношений. Например, исследование дружеских отношений между старшеклассниками, которое проводилось в трех временных точках - один раз в феврале, затем в марте и затем в апреле одного года (@fig:blockmodeling3). Во всех временных точках мы измеряем один и тот же тип отношений, которым является дружба. Таким образом, мы получаем три сети, наблюдаемые в каждой временной точке. Мы можем анализировать эти сети отдельно независимо друг от друга, но можем и заметить, что одни и те же единицы, наблюдаемые в разных временных точках, и связи из разных временных точек являются зависимыми.

![Сеть дружбы среди старшеклассников в 3 временных периодах](images/3_21_Maltseva_Network_clustering_and_blockmodeling.png){#fig:blockmodeling3}

Такие сети можно также представить в виде визуализации матричного типа на @fig:blockmodeling4. Мы включаем в это понятие типы сетей, также известные как «последовательности сетей или графов» или «многослойные сети» [@holme2015a, 5] или являющиеся продуктом «представления с потерями» [@holme2015a, 8-9] некоторых других типов, например, взвешенных графов и графов «временного окна», согласно Holme [@holme2015a, 8-9]. Таким образом, моментальные snapshot-сети состоят из серии измерений (не слишком больших) одного и того же отношения между (хотя бы частично) одними и теми же единицами.

Следует отметить, что в данном отчете мы не рассматриваем другие виды сетей, к которым относятся сетевые данные с временной меткой, или повторяющиеся события взаимодействия [@corneli2018], реляционные события / данные [@butts2008a] и последовательности контактов [@holme2015a].

![Коллекция сетей в разные моменты времени (динамическая сеть): два измерения представляют единицы (отправители и получатели связей), а третье измерение - моменты времени](images/4_21_Maltseva_Network_clustering_and_blockmodeling.jpg){#fig:blockmodeling4}

#### Применение блокмоделинга для динамических сетей
Подходы к блокмоделингу сетей, наблюдаемых в один момент времени, имеют давнюю традицию и хорошо изучены и оценены применительно к различным реальным и синтезированным сетям [@batagelj1992; @ferligoj2015a; @lorrainfrancois1971; 
 @schwartz1977; @snijders1997; @ziberna2009; @ziberna2021].

Только в последние годы исследователи предложили подходы к блокмоделингу динамических сетей. Идея блокмоделинга динамических сетей заключается в использовании того факта, что последовательно наблюдаемые сети являются зависимыми. Исследователи выдвинули идею о том, что учет зависимости между связями из разных временных точек может повысить достоверность результатов. Хотя цель блокмоделинга динамических сетей остается той же, что и при статическом блок-моделировании, - выявление эквивалентных групп единиц и связей между выявленными группами, - при изучении динамических сетей блокмоделинг проводится для сети в каждой временной точке, чтобы изучить, как изменяются структуры во времени.

Целью "обычного" блокмоделинга одномодальных сетей является поиск групп и связей между ними в одной одномодальной сети (т.е. сети со связями между одним набором единиц, измеряемых только в один момент времени). Существует множество подходов к блокмоделингу одномодальных сетей, такие как обобщенный блокмоделинг [@batagelj1999; @ziberna2007], блокмоделинг  методом k-means [@brusco2015; @hartigan1979; @ziberna2020] и стохастический блокмоделинг [@funke2019; @govaert2008; @peixoto2019; @snijders1997]. Практически все подходы к одномодальному блокмоделингу оценивают разбиение. Эти подходы также оценивают набор параметров или вычисляют статистики, описывающие связи между полученными группами, которые называются блокмоделью.

В отличие от этого, целью блокмоделинга _динамических_ сетей является поиск групп и связей между ними в динамической сети для каждого периода времени (_временной точки_) с учетом любой связи между группами из (близких) временных точек. Использование динамических подходов в отличие от «обычного» блокмоделинга для каждой временной точки в отдельности должно дать то преимущество, что при блокмоделировании определенной временной точки информация из других временных точек улучшает результат (в основном разбиение) для этой временной точки. Кроме того, динамическая модель может объяснить или показать, как сеть (структура, разбиение) изменяется во времени. Подходы к блокмоделингу динамических сетей также оценивают разбиения (обычно для каждой временной точки отдельно) и оценивают блокмодель для каждой временной точки. Кроме того, в них обычно каким-либо образом связываются ("параметры" или "решения для") различных временных точек. Часто они также накладывают определенное ограничение на решение или параметры, например, такое:

- Членство в группе не изменяется во времени, 
- Параметры связности или блокмодели (параметры, управляющие/описывающие модель связности между группами) не меняются во времени или существуют некоторые ограничения на эти изменения, 
- Все блоки должны присутствовать во всех временных точках.

Большинство подходов к блокмоделингу динамических сетей появилось недавно, и они разрабатывались независимо друг от друга. В этом случае возникает необходимость описать различные подходы к блокмоделингу динамических сетей, сравнить их и дать некоторые рекомендации по выбору подходов к блокмоделингу в различных условиях. Предлагаемые подходы к анализу динамических сетей можно отнести к детерминированному и стохастическому блокмоделингу, поэтому вначале мы опишем и сравним их (глава 2). Затем мы проанализируем подходы к блокмоделингу, которые были разработаны для изучения ненаправленных динамических сетей, например сетей научного сотрудничества (глава 3). 

Таким образом, в данной работе мы рассматриваем следующие подходы к блокмоделингу динамических сетей: 1) подходы, в которых осуществляется блокмоделинг сетей- моментальных снимков; 2) подходы, в которых членство в группе и блокмодель могут изменяться во времени. Сюда относятся как специально разработанные подходы к динамическим сетям, так и подходы, которые могут быть использованы для изучения моментальных сетей, например, подходы к блокмоделированию связанных или многосторонних сетей [@bar-hen2022; @skulj2022; @ziberna2019; @ziberna2020].

В недавней работе @cugmas2023 оценивались различные подходы к блокмоделингу динамических сетей на имитационных сетях. Сети моделировались методом Монте-Карло таким образом, чтобы они были ближе к реальным сетям, чем сети, созданные на основе простой стохастической блокмодели. Последнее было достигнуто за счет использования подхода к генерации сетей, позволяющего учитывать локальные сетевые механизмы при создании связей внутри блоков. В рамках данного имитационного исследования при сравнении сетей были рассмотрены некоторые вопросы. Во-первых, создание сетей с различными свойствами, чтобы учесть некоторые факторы, которые могут влиять на эффективность подходов блокмоделинга (рассматривались различные характеристики, такие как размер сети, тип блокмодели, устойчивость разделов). Второй момент заключался в том, чтобы сгенерировать эти сети таким образом, чтобы они были похожи на сети реального мира, что повысит достоверность имитационного исследования. Третья проблема заключалась в том, чтобы учесть некоторые локальные сетевые механизмы при генерации связей внутри или между группами. Также был предложен алгоритм генерации сетей с заданным типом блокмодели и заданным разбиением для оценки эффективности того или иного подхода к блокмоделингу. Результаты этого имитационного исследования представлены ниже. 

Следует, однако, отметить, что для тех типов сетей, которые не рассматриваются в данном отчете (временные данные сети / повторяющиеся события взаимодействия по [@matias2018], реляционные события / данные по [@butts2008a] или последовательности контактов по [@holme2015a]), также разработаны специальные подходы блокмоделинга (например, [@corneli2016; @corneli2018; @matias2018; @peixoto2017], и они могут быть проанализированы в дальнейшем. Существует множество подходов к блокмоделингу динамических сетей в широком смысле, т.е. не ограничивающихся сетями, измеренными в нескольких временных точках (обзор см. в [@kim2018; @lee2019a],  раздел SBM с лонгитюдным моделированием), которые также не анализируются ниже.

#### **_Оценка устойчивости блокмоделей_**
Рассмотрение различных начальных разделений является простым и очевидным решением и может привести к улучшению общей эффективности подходов к блокмоделингу. Для измерения сходства двух разделений разработано множество индексов [@albatineh2006]. Большинство из них предполагают наличие единого набора единиц для классификации, что может оказаться нецелесообразным для решения текущей задачи исследования. В случае изучения устойчивости ядер сети соавторства необходимо учитывать, что во втором временном интервале появляются новые исследователи, а другие покидают сеть. Это означает, что разделения получены не для одного и того же набора единиц. Кроме того, разделение и объединение кластеров оказывает одинаковое (негативное) влияние на значение этих показателей.

Эфективной мерой сходства между двумя кластеризациями данных является индекс Рэнда [@rand1971]. Индекс Рэнда — это точность определения принадлежности или непринадлежности связи к кластеру. Скорректированный индекс Рэнда (Adjusted Rand Index, ARI) был определен как форма индекса Рэнда, скорректированная с учетом случайности группировки элементов. Цель скорректированного индекса Рэнда - сравнить сходство между двумя результатами кластеризации. Более высокие значения указывают на большее сходство разделов. При точном совпадении двух разделений значение индекса равно 1. В случае двух случайных разделений ожидаемое значение индекса равно 0. Это позволяет сравнивать сходство разделений, полученных из разных сетей, разных размеров и с разным количеством кластеров.

Цугмас и Ферлигой [@cugmas2016] предложили три версии модифицированного индекса Рэнда, которые не предполагают единого набора единиц для классификации (один набор является подмножеством другого набора).

_Модифицированный индекс Рэнда 1 (MRI 1)_ предполагает, что второй набор единиц для классификации является подмножеством первого набора единиц. Данные первого и второго набора единиц обычно измеряются в двух временных точках (периодах). 

На примере сетей соавторства термин "единица" может обозначать исследователей, включенных в блокмоделинг. В контексте измерения устойчивости ядер исследователи, присутствующие в ядрах в первый период времени, но не присутствующие в сети во второй период времени (например, ушедшие на пенсию или не участвующие в соавторстве), или исследователи, которые были в одном из ядер в первый период времени, но находятся на полупериферии или периферии во второй период времени, обозначаются как выбывшие. Исследователи, отсутствовавшие в первом временном периоде (пришедшие), или исследователи, отнесенные в блокмодели к неосновной части, были удалены из сети, так как они не влияют на меру стабильности.

Мера определяется на интервале от 0 до 1, где большее значение меры указывает на более устойчивую классификацию. Значение 1 возможно только при отсутствии выпадающих кластеров. Объединение кластеров во втором временном интервале не приводит к снижению значения меры, в то время как разделение приводит. Предполагается, что объединение двух ядер не должно снижать значение меры устойчивости, поскольку объединение свидетельствует о большем количестве связей (соавторства) между исследователями, а это не влияет на связи, созданные в первом временном периоде. С другой стороны, если бы объединение ядер увеличивало значение меры, то максимальное значение меры было бы >1.

Поскольку ожидаемое значение двух случайных и независимых разбиений не принимает постоянного значения, Цугмас и Ферлигой (2015) предложили корректировку. Корректировка может быть получена путем моделирования, в котором порядок единиц двух разделений U и V независимо и случайно переставляется много раз. Для каждой перестановки обоих разделов вычисляется значение МРТ 1. Среднее из полученных значений представляет собой ожидаемое значение MRI 1 в случае двух случайных и независимых разделений. Значение _модифицированного скорректированного индекса Рэнда 1 (MARI 1_) рассчитывается следующим образом:
$$\mathnormal{MARI1} = \frac{\mathnormal{MRI1} - E(\mathnormal{MRI1})}{1 - E(\mathnormal{MRI1})} \quad (1)$$
Ожидаемое значение MARI 1 в случае двух случайных и независимых разделений равно 0, а максимальное - 1. Как уже отмечалось, в случае измерения устойчивости ядер блокмоделей соавторства по MRI 1 необходимо удалять из сети входящих исследователей. В процессе получения ожидаемого значения меры в случае двух случайных и независимых разбиений это можно делать до или после каждой перестановки исследователей каждого разбиения. В случае изучения устойчивости ядер сетей соавторства различия между указанными методами ожидаемо очень малы (значение коэффициента корреляции Пирсона на эмпирических данных составляет r=0,99). Эти различия могут быть объяснены многими факторами. Одним из наиболее заметных является доля исследователей, отнесенных в первом временном периоде к ядру, а во втором - к не-ядру.

В случае имитационных исследований (подобных представленному ниже) для сравнения расчетных и истинных разделений можно использовать Скорректированный Индекс Рэнда (ARI). В случае подхода динамического блокмоделинга, для количественной оценки эффективности того или иного подхода к блокмоделингу рассчитывается Скорректированный Индекс Рэнда (ARI) между истинным разделением и разделением, оцененным с помощью предложенных подходов. Этот расчет может быть выполнен для каждой временной точки, и далее мы анализировали среднее значение Индекса Рэнда по всем временным точкам. Скорректированный индекс Рэнда измеряет долю всех возможных пар, которые попадают в один и тот же кластер или в разные кластеры в обоих разделениях. Это позволяет оценить степень согласия между расчетным и истинным разделениями.

###  Детерминированный и стохастический блокмоделинг для анализа динамических сетей
#### _2.1. Детерминированный и стохастический блокмоделинг: общее разделение_  
Различные подходы блокмоделинга можно разделить на детерминированные и стохастические.  

В _детерминированных_ подходах к блокмоделингу итерационный алгоритм ищет гомогенные блоки по значениям связей. В рамках этого подхода можно выделить 1) _конвенциональный блокмоделинг_, известный также как непрямой блокмоделинг, и 2) _обобщенный блокмоделинг_.

Процедура _конвенционального блокмоделинга_ заключается в вычислении матрицы несходства по матрице смежности сети (можно использовать и другие статистики, описывающие блоки, например, распределение триад), а затем в использовании одного из стандартных алгоритмов кластеризации на этой матрице, например, подходов Ward или K-средних. Минусы такого подхода заключаются в том, что необходимо определить и вычислить совместимую меру сходства. Для эквивалентности структур это исправленное Евклидово расстояние, но иногда может оказаться, что для некоторых типов эквивалентности такой совместимой меры несходства не существует (регулярная эквивалентность - один из таких случаев). Кроме того, не существует явной меры соответствия (fit). 

Обобщенный блокмоделинг — это прямой подход, что подразумевает, что оптимизируется эксплицитная критериальная функция, при этом матрица сходства не вычисляется, вся процедура выполняется на уровне сетевых данных. Решение находится путем случайного перемещения узлов в кластере таким образом, чтобы минимизировать значение критериальной функции. В основе лежит обобщенная эквивалентность, то есть эквивалентность определяется на основе допустимых типов блоков. Критериальная функция отражает разницу между идеальной структурой сети и эмпирической структурой сети. Основная процедура вычисления критериальной функции состоит в следующем:

1. Матрица сети разбивается на блоки.   
2. Для всех допустимых типов блоков в каждом блоке вычисляется ошибка (несоответствие). 
3. Для каждого блока выбирается тип блока с минимальной ошибкой.
4. Вычисляется общая ошибка матрицы (сети) как сумма ошибок всех блоков.

Существует несколько видов обобщенного блокмоделинга: бинарный (binary), взвешенный (valued), имплицитный (implicit) блокмоделинг и блокмоделинг однородности (последние три могут быть применены и к взвешенным сетям).

Процедура обобщенного блокмоделинга различна для бинарных и взвешенных сетевых данных. В бинарных сетях значения связей не учитываются, а рассматривается только наличие или отсутствие связей. Ошибка вычисляется как количество связей, не совпадающих со связями идеальных блоков. Способ определения этих связей зависит от типа блока. Наиболее распространенными идеальными блоками являются NULL, COMPLETE, REGULAR, ROW-REGULAR и COLUMN-REGULAR. Для взвешенных сетей значения линий рассматриваются с заданным пороговым значением m, при превышении которого связи считаются значимыми. Несоответствия измеряются как отклонения от 0 (связь не должна присутствовать) или m (связь должна присутствовать). Отклонение от m вычисляется только в том случае, если значение связи меньше m. Основная проблема заключается в определении наиболее подходящего значения m. В этом может помочь рассмотрение распределений либо значений ячеек, либо значений функции f по строкам или столбцам. Бинарный блокмоделинг является частным случаем взвешенного блокмоделинга. 

Стохастический блокмоделинг основан на некоторой вероятностной модели. Предполагается наличие базовой статистической модели и ее оценка путем максимизации некоторой меры правдоподобия. Модель позволяет делать статистические выводы. Стохастические блокмодели (SBM) являются все более популярным классом моделей в статистическом анализе графов или сетей. Они могут использоваться для выявления или понимания (латентной) структуры сети, а также для кластеризации. Такая модель строится путем одновременного взятия каждой пары узлов и моделирования (неориентированного) ребра между ними. Вероятность наличия или отсутствия такого ребра не зависит от вероятности любой другой пары узлов.

#### _2.2. Детерминированный и стохастический блокмоделинг: подходы к анализу динамических сетей _

В обзоре подходов к детерминированному и стохастическому динамическому блокмоделингу сетей [@cugmas2023] рассматривались недавно предложенные подходов к блокмоделингу. Критерии отбора исключали подходы, которые еще не реализованы в R или MATLAB, а также подходы, реализованные таким образом, что во всех временных точках предполагается один и тот же тип блокмодели. В список были включены и те подходы к блокмоделингу, которые не были разработаны специально для блокмоделинга динамических сетей, но могут быть использованы для этой цели. Итоговый список рассмотренных подходов представлен в Табл. 1 (всего 11 подходов). Эти подходы характеризуются двумя признаками: типом характеристики подхода к блокмоделингу (стохастический или детерминистический) и способом обработки зависимостей между временными точками (модели пространства состояний, зависимые кластеры, связанные сети, отсутствие зависимостей). Для всех видов моделирования временных зависимостей разработаны только версии стохастического подхода к блокмоделингу, а детерминистические подходы (k-means и обобщенный блокмоделинг) учитывают временную зависимость только через связанные сети. 

Ниже эти подходы рассмотрены в зависимости от типа блокмоделинга и моделирования временных зависимостей, которые они предполагают.

|Name|Abbreviation|Reference|Blockmodeling approach|Time dependency modelling|Further restrictions|Is considered?|
|---|---|---|---|---|---|---|
|Dynamic stochastic blockmodels for time-evolving social networks (with state-space models)|DSBMwSSM|([Xu and Hero, 2014](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib44))|Stochastic|State-space models||YES|
|Stochastic block transition models for dynamic networks (with state-space models)|SBTMwSSM|([Xu, 2015](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib43))|Stochastic|State-space models||YES|
|Statistical clustering of temporal networks through a dynamic stochastic block model|DSBM|([Matias and Miele, 2017](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib28))|Stochastic|Dependent clusters|Within-cluster tie probabilities are constrained to be equal across timepoints to control the label-switching problem|YES|
|An exact algorithm for time-dependent variational inference for the dynamic stochastic block model|EDSBM|([Bartolucci and Pandolfi, 2020](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib3))|Stochastic|Dependent clusters|The blockmodel/ connectivity parameters cannot change in time|NO – do not allow the connectivity parameters to change in time|
|Stochastic blockmodeling for multilevel networks|SBMfMLN|([Chabert-Liddell et al., 2021](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib10), [Chabert-Liddell, 2022](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib9))|Stochastic|Dependent clusters|The approach was originally designed for two levels and therefore only two time points; still, extensions have been proposed to multiple levels/timepoints and only recently implemented|NO – not implemented for more than two time points at the time of preparing the simulations|
|Block models for generalised multipartite networks|SBMfMPN|([Bar-Hen et al., 2020](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib2))|Stochastic|Linked networks||YES|
|Stochastic blockmodeling for linked networks|SBMfLN|([Škulj and Žiberna, 2022](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib36))|Stochastic|Linked networks||YES|
|Generalised blockmodeling for linked networks|GBMfLN|([Žiberna,  2019](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib48))|Deterministic - Generalised|Linked networks||NO – too slow|
|K-means-based algorithm for blockmodeling linked networks|KMfLN|([Žiberna,  2020](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib49))|Deterministic - k-means|Linked networks||YES|
|Stochastic blockmodeling|SBM|Overview<br><br>[Funke and Becker, 2019](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib17);  implementation used<br><br>[Škulj and Žiberna, 2022](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib36))|Stochastic|none||YES|
|K-means based blockmodeling|KM|([Žiberna,  2020](https://www.sciencedirect.com/science/article/pii/S0378873322001022#bib49))|Deterministic - k-means|none||YES|

#### Динамические стохастические блокмодели с использованием <u>моделей пространства состояний (state-space models)
Отнесение моделей к _моделям пространства состояний_ подразумевает, что значения параметров (плотности блоков) в текущей временной точке оцениваются "условно" по параметрам предыдущей временной точки.

Модель _Динамических стохастических блокмоделей_ для развивающихся во времени социальных сетей (с моделями в пространстве состояний), или _Dynamic stochastic blockmodels for time-evolving social networks (with state-space models) (DSBMwSSM)_, представленная Xu и Hero (2014) [@xu2014], основана на статической стохастической блокмодели - классической стохастической блокмодели для одномодальных сетей, которую они используют в качестве статической модели для сети отдельных временных точек, а для моделирования динамики сети применяют модель пространства состояний. Модель разработана только для бинарных сетей. В основе модели лежит предположение о том, что блокмодель, точнее матрица внутриблочных вероятностей связей, эволюционирует как некое случайное блуждание. Поскольку вероятности связей ограничены в диапазоне от 0 до 1, для их преобразования в неограниченные вещественные числа используется логит-преобразование. Эта параметризация, в свою очередь, используется в режиме пространства состояний: при переходе от времени t - 1 к времени t эти параметры сначала преобразуются на основе модели перехода состояний, а затем к преобразованным состояниям добавляется шум многомерного нормального процесса с нулевым средним значением. При этом используется интерактивная оценка, то есть при блокмоделировании временной точки t рассматриваются только временные точки от 1 до t.

Одним из недостатков подхода является то, что матрица преобразования состояний и ковариационная матрица шума процесса обычно неизвестны. Последняя должна задаваться пользователем и является особенно проблематичной, так как существенно влияет на результаты. Фактически для определения этой матрицы необходимо установить два параметра - дисперсии (при прочих равных условиях) и ковариации. Одним из вариантов является сеточный поиск их разумных комбинаций, однако это увеличивает временную сложность, а также неясно, какой критерий выбора модели лучше использовать для получения результатов. Лог-правдоподобие (log-likelihood) всей модели не существует (из-за использования модели пространства состояний для моделирования динамики) и, следовательно, не может быть использовано для этой цели. При оценке разбиения для времени t фактически максимизируется не логарифмическое правдоподобие, а апостериорная плотность состояния. Как отмечают авторы, "процедура вывода состоит из расширенного фильтра Калмана (EKF) [@haykin2001], дополненного стратегией локального поиска". Процедура вывода является интерактивной, то есть при измерении оценки состояния в момент времени t используется только информация до момента времени t (включительно).

Позже Xu (2015) [@xu2015] расширил эту модель, назвав ее_ Стохастической моделью блочного перехода для динамических сетей, или Stochastic block transition model for dynamic networks (SBTMwSS),_ в которой вероятность присутствия связи зависит уже не только от блока, в котором эта связь находится, но и от того, присутствовала ли она в предыдущий момент времени. То есть если в другой модели для бинарных сетей существует одна вероятность, определяющая вероятность наличия связи в блоке, то в данной модели их две, одна из которых используется, если связь не присутствовала в предыдущих временных точках, а другая - если присутствовала. Естественно, что для первой временной точки используется только одна модель. В остальном модель очень похожа на DSBMwSSM, предложенную в работе Xu и Hero (2014) [@xu2014], включая процедуру оценки.

#### Динамические <u>стохастические блок-модели с управлением переключения лейблов (control for label switching)
Следующий подход к динамическим стохастическим блок-моделям основан на _условных кластерных вероятностях (conditional cluster probabilities)_: кластерные вероятности в текущей временной точке зависят от принадлежности к кластеру в предыдущей временной точке (точках); модели предполагают контроль переключения лейблов.

Этот подход был разработан Матиасом и Миле [@matias2017], которые предложили динамическую стохастическую блокмодель, позволяющую контролировать переключение лейблов, т.е. они гарантируют, что один и тот же кластер имеет один и тот же лейбл во всех временных точках. Их подход к _Статистической кластеризации временных сетей с помощью динамической стохастической блокмодели, или Statistical clustering of temporal networks through a dynamic stochastic block model (DSBM)_, основан на _Стохастической блокмодели, или Stochastic blockmodel (SBM)_; точнее, каждая временная точка моделируется как SBM. Вероятности связей (для бинарных сетей или, в более общем случае, параметры, определяющие распределение вероятностей значений связей) в заданный момент времени зависят только от латентных групп/кластеров, то есть только от разбиения в этот момент времени. В принципе, это означает, что параметры связности (блокмодель) могут быть различными в разных временных точках, хотя изменение параметров связности во времени ограничено. Временные точки связаны между собой тем, что вероятности кластеров для каждой временной точки (кроме первой) зависят от принадлежности к кластеру в предыдущей временной точке. Как отмечают Матиас и Миле, один из подходов обусловлен необходимостью контроля проблем переключения лейблов в разных временных точках, то есть они хотят обеспечить, чтобы один и тот же кластер имел один и тот же "лейбл" во всех временных точках. Они решают проблему переключения лейблов путем поиска групп, которые имеют стабильное поведение внутригрупповой связности. Это достигается путем ограничения параметров связности диагональных блоков (которые моделируют связи внутри групп) на постоянство в разных временных точках. Вероятности внутригрупповых связей фиксируются во времени. Как отмечают авторы, такой контроль за переключением лейблов является ключевым отличием от модели DSBMwSSM, предложенной в работе Xu и Hero (2014). 

Для оценки параметров используется приближенная процедура [@bartolucci2020], основанная на алгоритме вариационного ожидания-максимизации, или variational expectation–maximisation algorithm (VEM). В работе Bartolucci and Pandolfi (2020) [@bartolucci2020] также предложен точный алгоритм, оптимизирующий ту же целевую функцию - _Точный алгоритм зависящего от времени вариационного вывода для динамической стохастической блочной модели, или Exact algorithm for time-dependent variational inference for the dynamic stochastic block model (EDSBM),_ однако их подход ниже не рассматривается, поскольку они не допускают изменения параметров связности во времени, что является частью критерия включения при выборе подходов. 

Моделью, аналогичной модели Matias и Miele (2017) [@matias2017], является модель, предложенная Chabert-Liddell et al. (2021) [@chabert-liddell2021], -_Стохастический блокмоделинг для многоуровневых сетей, или Stochastic blockmodeling for multilevel networks (SBMfMLN)_. Эта модель явно предназначена не для динамических сетей, а для многоуровневых сетей. Модель очень похожа на модель Matias и Miele (2017) с двумя основными отличиями. Во-первых, в ней не решается проблема переключения лейблов, что не актуально для многоуровневых сетей. Изначально она разрабатывалась только для двухуровневых сетей (и поэтому могла использоваться только для темпоральных сетей с двумя временными точками. Позднее [@chabert-liddell] модель была обобщена на любое число уровней и, следовательно, на динамические сети, измеряемые в любое число временных точек. Однако это обобщение еще не было реализовано. Как и в модели Matias и Miele (2017), уровни сети (в данном случае) связаны между собой путем установления зависимости вероятностей кластеров второго уровня от принадлежности к соответствующей единице первого уровня.

#### Стохастический блокмоделинг для многосторонних или связанных сетей
Подходы, представленные в данной группе, предполагают наличие связанных и многосторонних сетей: совокупность как минимум двух одномодальных сетей и одной двумодальной сети, связывающей эти одномодальные сети. В контексте динамических сетей двумодальные сети "связывают" одни и те же единицы из разных временных точек. Такая сеть блок-моделируется как единая сеть (с ограничением, что узлы из разных одномодальных сетей не могут смешиваться).

Представленные здесь подходы разработаны не специально для динамических сетей, а для того, что Бар-Хен и др. [@bar-hen2022] называют "обобщенными многосторонними сетями" (“generalised multipartite networks”), а Жиберна [@ziberna2019] - "связанными сетями" (“linked networks”). Этот тип сетей можно рассматривать как совокупность одномодальных и двумодальных сетей, где сети имеют одинаковые наборы единиц. В качестве альтернативы (более подходящей для динамического анализа сетей) их можно рассматривать как совокупность одномодальных сетей, связанных с двумодальными сетями. Эта структура данных может быть использована для представления одномодальных сетей, измеренных в нескольких временных точках. В этом случае одномодальные сети, измеренные в нескольких временных точках, очевидно, представляют собой одномодальные сети (по одной для каждой временной точки), а двумодальные сети используются для "соединения" одних и тех же единиц в разных (обычно последовательных) временных точках (как показано на @fig:blockmodeling5).

![Иллюстрация одномодальных и двумодальных сетей, представляющих собой одномодальные сети, измеренные в разные моменты времени](images/5_21_Maltseva_Network_clustering_and_blockmodeling.jpg){#fig:blockmodeling5}

Другой взгляд на связанную сеть состоит в том, что это просто гигантская сеть с различными наборами единиц, где требуется найти такие разбиения всех наборов единиц, чтобы кластеры состояли только из единиц одного набора, при этом при разбиении данного набора учитывается вся сеть, а также разбиения других наборов. В случае динамических сетей каждое множество будет представлять единицы, присутствующие в одной временной точке. Связи внутри множеств представляют собой отношения между наблюдаемыми единицами в данной временной точке, а связи между множествами представляют собой "однотипные" (“same-unit”) отношения (т.е. связывают одну и ту же единицу в соседних временных точках).

Преимуществом данного подхода является его гибкость, поскольку он подходит не только для динамических сетей, но и для других типов связанных сетей, например, многоуровневых или динамических многоуровневых сетей. Недостатком является то, что он не приспособлен специально для динамических сетей. Проблема заключается в том, что двумодальные "однотипные" сети имеют некоторые ограничения, которые не учитываются стохастической блокмоделью, а именно: каждый блок может иметь не более одной связи. Кроме того, эти подходы не решают проблему переключения лейблов, что также можно рассматривать как преимущество, поскольку это означает, что они не накладывают никаких ограничений на блокмодель или ее изменения во времени и не требуют одинакового количества кластеров во всех временных точках.

Два подхода, которые мы рассматриваем в этом разделе, - _Блокмодели для обобщенных многосторонних сетей, или Block models for generalised multipartite networks (SBMfMPN)_ Бар-Хена и др. [@bar-hen2022] и _Стохастический блокмоделинг для связанных сетей, или Stochastic blockmodeling for linked networks (SBMfLN_) Шкуля и Жиберна [@skulj2022] - очень похожи и оценивают практически одну и ту же модель, с тем лишь исключением, что в последней модели также предусмотрена возможность взвешивания. Кроме того, они используют разные стратегии оценивания. Подход SBMfMPN, предложенный Bar-Hen et al. (2020) [@bar-hen2022], оценивает модель с помощью алгоритма максимизации вариационного ожидания (VEM), который инициализируется либо на основе разбиения, полученного с помощью иерархической кластеризации, либо с помощью отдельного блокмоделинга соответствующих подсетей (отметим, что важной частью процедуры оптимизации является также исследование разбиений, полученных путем разделения или слияния выбранных кластеров на предыдущей итерации). В подходе SBMfLN, предложенном Škulj и Žiberna (2022) [@skulj2022], используется алгоритм максимизации классификационного ожидания (CEM), инициализируемый множеством случайных разбиений. 

#### Подходы детерминистического блокмоделинга для связанных сетей
До представленных выше подходов для связанных сетей были разработаны два нестохастических подхода к блокмоделингу: _Обобщенный блокмоделинг_, или _Generalised blockmodeling_ и _Блокмоделинг методом k-средних, k-means blockmodeling._

Обобщенный блокмоделинг был впервые разработан для многоуровневых сетей [@ziberna2014], но было показано, что этот же подход может быть использован и для других типов связанных сетей, в том числе динамических - _Обобщенный блокмоделинг для связанных сетей, или Generalised blockmodeling for linked networks (GBMfLN) [@ziberna2019]_. Обобщенный блокмоделинг — это очень гибкий подход для блокмоделинга бинарных и взвешенных сетей. Его гибкость обусловлена тем, что он может находить разделения на основе различных типов эквивалентности, включая структурную, регулярную и обобщенную эквивалентность [@batagelj1999]. Последний тип эквивалентности позволяет задавать различные типы блоков, где каждый тип блока представляет собой различное ожидание модели связей между двумя кластерами. В силу своей общности он использует для оптимизации алгоритм перемещения (relocation), что приводит к тому, что он становится слишком медленным для большинства связанных сетей, которые (по своей природе являясь комбинацией различных сетей) больше, чем типичные одномодальные сети. 

Другим подходом является _Обобщенное блокмоделирование однородности суммы квадратов, Sum of squares homogeneity generalised blockmodeling_ [@ziberna2007], которое минимизирует сумму внутриблочных квадратичных отклонений от среднего (для всех блоков сети) при использовании структурной эквивалентности. Этот же критерий минимизируется и в рамках _Блокмоделинга методом k-средних для связанных сетей, или k-means blockmodeling for linked networks (KMfLM)_. Поскольку подход k-means значительно быстрее обобщенного блочного моделирования и, следовательно, достаточно эффективен при работе со связанными сетями, рассматривался только этот нестохастический подход.

#### Отдельный блокмоделинг для каждой временной точки
Выше были представлены подходы, которые могут быть использованы для блокмоделинга сетей во всех временных точках одновременно с учетом информации о соседних/других временных точках. Однако наиболее простым подходом к блокмоделингу snapshot-сетей является блокмоделинг сети в каждой временной точке отдельно (примеры см. в    [@cugmas2016; @doreian1996; @doreian2011]. Жиберна [@ziberna2019] называет такой подход "раздельным анализом" и утверждает, что практически он является необходимым первым (по крайней мере, исследовательским) шагом в блокмоделинге любой связанной, а значит, и динамической сети. Такие модели не предполагают моделирования зависимости от времени.

Для этого можно использовать любой подход к одномодальному блокмоделингу, но мы рассматриваем только частные случаи подходов к динамическим сетям. Поэтому для сравнения различных подходов мы используем только _Блокмоделинга методом k-средних для одномодальных сетей_, _или k-means blockmodeling for one-mode networks - KM_ [@ziberna2020] (детерминистический подход) и _Стохастический блокмоделинг, Stochastic blockmodeling - SBM_ ([@airoldi2008], [@govaert2008], [@peixoto2019], [@snijders1997]) (стохастический подход).

#### Детерминированный и стохастический блокмоделинг: подходы для анализа ненаправленных сетей
В данной части рассмотрены только те подходы в области динамического блокмоделинга сетей, которые могут быть использованы для блокмоделинга ненаправленных динамических сетей. Случай ненаправленных сетей интересен для исследования тем, что модели могут быть применены к эмпирическим данным о сотрудничестве между учеными, основанном на их соавторстве.

Для сетей соавторства характерны некоторые особенности, такие как симметричные связи, наличие новичков и ушедших. Анализ сетей соавторства [@cugmas2016] показал, что в них присутствует значительная доля новичков и аутсайдеров, что приводит к образованию относительно неустойчивых кластеров в структуре глобальной сети. Была обнаружена типичная структура "мульти-ядро - полупериферия - периферия", причем этот тип блокмодели остается относительно стабильным во времени. Этот фактор стабильности становится решающим при выборе между различными подходами к блокмоделингу. Для анализа динамики сетей соавторства словенских исследователей ставился вопрос о том, какой подход к блокмоделингу следует использовать. Этот вопрос может быть решен в ходе имитационного исследования.

Не все подходы, представленные в Табл. 1, могут быть использованы для блокмоделинга динамических ненаправленных данных. Были рассмотрены отдельные подходы к блокмоделингу, которые могут быть использованы при анализе динамических сетей, а также отдельные подходы к блокмоделингу (если сети рассматриваются только в одной временной точке), таким образом, что сети для каждой временной точки блок-моделируются отдельно:

1. Стохастический блокмоделинг - SBM (Mariadassou et al., 2010)
2. Блокмоделинг на основе K-средних - KM [@ziberna2020]
3. Байесовский стохастический блокмоделинг - BSBM [@peixoto2019].

Также применялись подходы, разработанные для анализа динамических сетей. Подходы Dynamic stochastic blockmodels for time-evolving social networks (with state-space models) - DSBMwSSM [@xu2014] и Stochastic block transition models for dynamic networks (with state-space models) - SBTMwSSM [@xu2015] не были включены в сравнение, поскольку они не позволяют учитывать входящие и выходящие узлы. Для анализа были выбраны следующие подходы:   

4. Статистическая кластеризация временных сетей с помощью динамической стохастической блокмодели - DSBM [@matias2017]
5. Стохастический подход блокмоделинга для анализа многоуровневых сетей - SBMfML [@chabert-liddell]
6. Байесовский стохастический блокмоделинг - BSBMfLN [@peixoto2019]
7. Блокмодели для обобщенных многосторонних сетей - SBMfMPN [@bar-hen2022]
8. Стохастический блокмоделинг для связанных сетей - SBMfLN [@skulj2022]
9. Алгоритм на основе K-средних для блокмоделирования связанных сетей - KMfLN [@ziberna2020]

_Стохастический подход блокмоделинга для анализа многоуровневых сетей, или_ _Stochastic_ _blockmodel_ _approach_ _for_ _the_ _analysis_ _of_ _multilevel_ _networks_ _- SBMfML_ [@chabert-liddell] очень похож на _Динамический стохастический блокмоделинг, или_ _Dynamic_ _Stochastic_ _Blockmodeling_, предложенный Matias & Miele (2017) [@matias2017]. Количество групп не фиксировано для всех временных точек, а диагональные блоки могут меняться со временем в подходе _Стохастического блокмоделинга для многоуровневых сетей, Stochastic blockmodeling for multilevel networks - SBMfMLN_. В подходе _Динамического стохастического блокмоделинга_, предложенного Matias & Miele (2017), предполагается, что плотность диагональных блоков не должна меняться со временем, однако в подходе Chabert-Liddell (2022) [@chabert-liddell] это не так. Кроме того, Matias & Miele также предполагают, что количество кластеров одинаково во всех временных точках. В подходе _Байесовского стохастического блокмоделинга, Bayesian stochastic blockmodeling - BSBM_ [@peixoto2019] предполагается распределение связей Пуассона, что хорошо работает, особенно для разреженных сетей.

### Сравнение подходов к динамическому блокмоделингу: результаты имитационных исследований
#### _Сравнение детерминированных и стохастических подходов к динамическому блокмоделингу_

Для сравнения подходов для направленных сетей было проведено имитационное исследование методом Монте-Карло, которое было представлено в работе Цугмаса и Жиберна [@cugmas2023]. Целью исследования было определение различий в эффективности различных подходов к блокмоделингу динамических сетей, определяемых как сети моментальных снимков, наблюдаемых в нескольких временных точках или периодах времени на одном и том же наборе единиц и с одним и тем же типом связи между единицами.

Выбранные подходы к блокмоделингу оценивались с учетом нескольких факторов, т.е. характеристик сети. Рассмотренные подходы к блокмоделингу применялись к синтизированным сетям с различными свойствами, такими как размер (48 или 96 узлов), устойчивость групп (стабильность – членство в группе; четыре случая: обмен 0%, 16%, 33%, 100% узлов), разница между плотностями блоков (нулевой и полной) и переходами между типами блок-моделей (две сплоченные и одна периферийная группы, где могут измениться два или четыре внедиагональных блока, а также один или два внедиагональный и один или два диагональный блок). Связи между группами обычно не являются случайными и возникают под действием некоторых социальных механизмов ([@hedstrom1998b], [@stadtfeld2018]), таких как взаимность, популярность, транзитивность, а также механизм исходящих партнеров (outgoing-shared partner) - тенденция к созданию связей с теми, кто "нравится другим". В эксперименте были возможны два сценария: 1) механизмы локальной сети не учитываются, то есть связи генерируются совершенно случайным образом, и 2) механизмы учитываются, и получаются различные типы блок-моделей. Во всех генерируемых сетях предполагалось, что известно истинное число групп – три группы. В исследовании предполагалось, что все узлы одинаковы во всех временных точках (т.е. нет входящих и выходящих узлов). Для каждой комбинации факторов было сгенерировано десять сетей.

Алгоритм генерации сетей является итерационным, поэтому пришлось задать число итераций равным 2500. Подход к генерации сетей показан на @fig:blockmodeling6 (подробнее см. [@cugmas2023]).

![Итерационный подход к генерации сетей: динамический блокмоделинг сетей](images/6_21_Maltseva_Network_clustering_and_blockmodeling.png){#fig:blockmodeling6}

Сначала проводился блокмоделинг сетей с использованием подходов для раздельного блокмоделинга сетей, наблюдаемых в разные временные точки (раздельный блокмоделинг). Здесь использовались стохастический подход к блокмоделингу (SBM), оцененный с помощью алгоритма CEM [@skulj2022], и подход к блокмоделингу на основе k-средних [@ziberna2020]. Также применялись подходы блокмоделинга для динамических, связанных и многоуровневых сетей. Подходы к блокмоделированию оценивались по скорректированному индексу Рэнда [@rand1971], который измеряет сходство истинных разделений и разделений, полученных с помощью блокмоделирования.

В результате анализа было  показано, что локальные сетевые механизмы могут влиять на решения блокмоделинга. Например, в реализованном исследовании средние значения ARI были ниже при учете механизмов по сравнению с тем, когда связи внутри блоков генерировались случайным образом. Другим важным фактором является изменение типа блокмодели во времени. Более выраженные изменения типа блокмодели приводят к более низким средним значениям ARI.

Низкая устойчивость групп во времени приводит к худшим результатам подходов блокмоделинга для динамических сетей. Более низкие результаты наблюдаются в тех случаях, когда разбиение из первой временной точки и разбиение в последней временной точке являются независимыми. В этом случае блокмоделинг сетей, наблюдаемых в разные моменты времени по отдельности, может дать приемлемые результаты. Однако при наличии хотя бы некоторой зависимости между разделениями рекомендуется рассмотреть подходы блокмоделинга для динамических сетей.

В целом ожидается, что статистическая кластеризация временных сетей с помощью динамической стохастической блокмодели - DSBM [@matias2017] даст наилучшие результаты, если тип блокмодели одинаков во всех временных точках (не изменяется во времени). Такой подход к моделированию блоков предлагается независимо от устойчивости разделений и возможных социальных механизмов, влияющих на связи внутри блоков.

Если предполагается, что тип блокмодели будет меняться во времени, то оптимальными могут оказаться блокмодели для обобщенных многосторонних сетей - SBMfMPN [@bar-hen2022] и динамические стохастические блокмодели для эволюционирующих во времени сетей - SBTMwSSM [@xu2015], причем в большинстве случаев предпочтение следует отдать SBMfMPN.

Поскольку характеристики сети (тип блокмодели, устойчивость группы, локальные механизмы сети) существенно влияют на эффективность подходов к блокмоделингу, настоятельно рекомендуется учитывать предварительные знания о сети и возможные предварительные (например, отдельные блок-модели) анализы. Кроме того, учет различных начальных разбиений может привести к лучшим значениям критериальной величины (а значит, и к более подходящему решению) и способствовать сходимости моделей. Рекомендуется использовать различные начальные разделения (например, из отдельных анализов) и сохранять решение с наилучшим значением критерия.

В дальнейших исследованиях было бы полезно оценить подходы к блокмоделированию в ситуациях с более неоднородным количеством кластеров в сетях, более неоднородными размерами кластеров в сетях, а также когда истинное количество кластеров неизвестно. На решение в рамках блокмоделинга также может повлиять количество рассматриваемых временных точек и/или время между временными точками. Поскольку это напрямую связано с динамикой сети, т.е. с устойчивостью типа блокмодели и разбиения, предполагается, что подходы к блокмоделингу динамических сетей могут принести меньше пользы по сравнению с раздельным анализом, если время между временными точками больше, исходя из того, что социальные сети имеют тенденцию изменяться во времени. Несмотря на то что в данном исследовании были получены сети, напоминающие характеристики реальных сетей, в будущем следует предпринять попытки оценить достоверность подходов блокмоделинга на реальных сетях.

#### **_Сравнение детерминированных и стохастических  подходов к динамическому блокмоделингу ненаправленных сетей_**
После проведенного исследования было рекомендовано на дальнейших этапах сравнения подходов динамического блокмоделинга учитывать возможность присоединения и выхода единиц из сети с течением времени, что часто происходит в динамических социальных сетях реального мира. Было решено провести аналогичную оценку для ненаправленных сетей, для чего алгоритм генерации сетей должен быть соответствующим образом адаптирован.

В имитационном исследовании, выполненном Цугмасом и Жиберна, в качестве случайных эффектов рассматривались те же сценарии размера сети (48 против 96) и стабильности (перехода группы) (0% против 33% против 66% против 100%), что и в предыдущих случаях, но с учетом изменений в механизмах, а также новичков и ушедших.

Исследовалось четыре сценария для новичков и ушедших (выбывших):

* Новые участники (0 против 50%, по сравнению с размером сети в первой временной точке)
* Выбывшие (0 против 20%, по сравнению с размером сети в первой временной точке)

Было обнаружено, что приход новых участников не изменял размер сети, а уход - уменьшал. Когда новички присоединяются к группе, у них нет существующих связей с другими участниками, и группа, к которой они присоединяются, определяется с вероятностью, пропорциональной ее размеру. Это реалистично для сетей соавторства или исследовательских групп, где большие группы имеют больше шансов привлечь новых коллег, возможно, из-за наличия финансовых ресурсов. При этом все группы в сети имеют одинаковую вероятность выхода, за двумя исключениями. Чтобы избежать появления очень маленьких групп, ни одна единица из группы не могла покинуть ее, если группа состоит из пяти или менее единиц. Кроме того, новички также не могут покинуть сеть в течение одного и того же периода времени.

Что касается _механизмов_, то мы либо использовали механизмы, либо учитывали такие механизмы, как популярность, транзитивность и ассортативность (склонность к созданию связей с теми, кто имеет схожие показатели in-degree). В случае популярности есть предпочтение устанавливать связи с теми, кто очень популярен. В случае с ассортативностью есть предпочтение связываться с теми, кто имеет схожий уровень популярности. Также учитывается транзитивность - склонность узла устанавливать связи с теми, кто нравится связанному с ним узлу.

В качестве _фиксированных эффектов_ использовалось одинаковое количество групп (3 группы), плотность блоков (5% в нулевых блоках и 25% в полных блоках). Что касается типов блокмоделей, то они также различны, но количество возможных типов блок-моделей ограничено из-за наличия симметричных связей. Начальный тип блокмодели аналогичен тому, который был использован при анализе динамического блокмоделинга сети, с двумя сплоченными группами и одной периферийной группой. Далее мы исследуем три сценария окончательной структуры глобальной сети. В первом случае ничего не меняется, то есть структура глобальной сети остается прежней. Во втором сценарии происходят два слияния, в результате чего появляются связи между первой и второй группой и первой и третьей группой. В третьем сценарии изменяется один диагональный и один внедиагональный блок, при этом исчезают связи внутри блоков второй группы и появляются связи между первой и второй группами.

_Алгоритм генерации сетей_ аналогичен описанному выше (подробнее см. [@cugmas2023]), с дополнительным шагом задания количества пришедших и ушедших, а также минимального размера кластера. Процедура генерации сетей, в которой было использовано 50 000 итераций, показана на @fig:blockmodeling7.

![Итерационный подход для генерации сетей: динамический блокмоделинг ненаправленных сетей](images/7_21_Maltseva_Network_clustering_and_blockmodeling.png){#fig:blockmodeling7}

Алгоритмы запускались дважды: с начальным разбиением по умолчанию, а затем с начальным разбиением, полученным в результате раздельного блокмоделинга. Для динамических сетей для каждого подхода получено два набора результатов, причем для каждого подхода, примененного к динамическим сетям, был оставлен и далее проанализирован тот, который имеет наилучшее значение оптимизированной критериальной функции. Для сравнения истинного и полученного с помощью этих подходов разбиения для динамических сетей в каждой временной точке применен скорректированный индекс Рэнда (ARI) (для измерения степени сходства расчетных разбиений с истинными). Были вычислены среднее значение ARI по всем временным точкам и далее проинтерпретированы полученные результаты.

На основании полученных результатов можно дать следующие рекомендации:

1. Стохастический подход блокмоделинга для анализа многоуровневых сетей - SBMfML [@chabert-liddell] является очень надежным выбором, когда нет входящих и выходящих узлов.
2. Стохастический блокмоделинг для многосторонних сетей - SBMfMPN [@bar-hen2022] - безопасный выбор, когда есть входящие и выходящие узлы. Однако следует иметь в виду, что иногда могут возникать проблемы со сходимостью, хотя это случается редко.
3. Алгоритм блокмоделинга связанных сетей на основе K-средних - KMfLN [@ziberna2020] в целом эффективен, но может быть превзойден другими подходами. Лучше всего он работает, если связи внутри блоков устанавливаются случайным образом. Его можно рассматривать как надежный вариант, хотя могут существовать альтернативы, дающие лучшие результаты.
4. Динамическая стохастическая блокмодель - DSBM [@matias2017] работает очень хорошо, если можно предположить, что связи в блоках или кластерах устанавливаются случайно, особенно в больших сетях и когда тип блокмодели не меняется. Однако при изменении типа блокмодели и больших размерах сети его производительность оказывается относительно ниже по сравнению с другими подходами. В таких случаях более эффективными могут оказаться другие подходы.

В дальнейшем эти подходы к блокмоделингу следует применять и оценивать на реальных сетях соавторства, учитывая значительный объем знаний о сетях сотрудничества в случае словенских исследователей. 

В качестве общих рекомендаций следует отметить, что при начале анализа сети всегда целесообразно использовать предыдущие знания и проводить отдельные анализы. Целесообразно начинать с отдельных предварительных анализов для подтверждения знаний о сети. На эффективность подходов блокмоделинга могут влиять различные факторы. Вторая рекомендация - попробовать использовать различные начальные разбиения, например, начальное разбиение по умолчанию или из отдельных анализов. Следует оставить решение с наилучшим значением критерия. Кроме того, можно рассмотреть возможность анализа каждой временной точки отдельно и использовать эти результаты в качестве начальных разделов для динамического блокмоделинга. В некоторых случаях это может повысить эффективность подхода блокмоделирования.

### Блокмоделинг для изучения сетей соавторства

При анализе сетей соавторства многие ученые изучали преимущества сплоченных социальных структур, организованных в четко определенные, тесно связанные сообщества связанных между собой индивидов. Было показано, что блокмоделинг может быть эффективно использован для решения соответствующих исследовательских задач, разрабатываемых в области научного сотрудничества исследователей. Существует несколько типичных вариантов его использования, таких как:

1. Поиск кластеров единиц, имеющих эквивалентные (в некотором смысле) связи с другими единицами.
   Блокмоделинг может применяться для выявления исследователей, имеющих схожие модели научного сотрудничества, и для выявления глобальной (сетевой) структуры научного сотрудничества, не накладывая при этом никаких предположений на глобальную сетевую структуру.
2. Поиск кластеров единиц в соответствии с некоторой заранее заданной структурой сети.
   Мы знаем, что структура глобальной сети имеет вид, например, ядро-периферия. Блокмоделинг может применяться для того, чтобы определить, какие исследователи относятся к ядру, а какие - к периферии.
3. Оценка соответствия заданного разбиения ко всей сети (и заданной заранее структуре).
   Можно предположить, что структура глобальной сети имеет вид "ядро-периферия". Блокмоделинг применяется для оценки соответствия эмпирической сети структуре "ядро-периферия". Также может существовать разбиение, определяемое принадлежностью к научному полю, и можно оценить, насколько это разбиение соответствует сплоченной сетевой структуре.

Вопрос о сплоченных социальных структурах может быть частично распространен на уровень долгосрочных и краткосрочных научных коллабораций. Однако в литературе еще недостаточно внимания уделяется факторам, влияющим на устойчивость коллаборативных связей, что включает вопросы динамики и стабильности полученных структур. Ниже рассмотрено несколько примеров применения блокмоделинга для изучения устойчивости и динамики сетей соавторства на примере словенской науки.

Кронеггер и др. [@doreian2011] исследовали структуру сетей соавторства четырех научных дисциплин (физики, математики, биотехнологии и социологии) за четыре 5-летних периода (1986-2005 гг.). Один из ключевых выводов состоит в том, что независимо от научной дисциплины структура соавторства очень быстро консолидируется в мульти-ядро - полупериферию - периферию. Термин "ядро" обозначает группу исследователей, которые систематически публикуются вместе друг с другом. Полупериферия состоит из исследователей, которые публикуются в соавторстве менее систематически, но имеют хотя бы одну публикацию в соавторстве с исследователями из данной дисциплины; периферия включает авторов, которые публикуются только как единственные авторы или с авторами, не входящими в границы определенной дисциплинарной сети [@Mali2012]. В работе Kronegger et al. (2011) [@doreian2011] также рассматривался вопрос об устойчивости ядер (групп исследователей) в контексте изучения эволюции блок-модельной структуры во времени с помощью визуального представления.

В более позднем исследовании Cugmas et al. (2016) [@cugmas2016] рассмотрена структура устойчивости сетей соавторства во времени. Процедура блокмоделинга была применена к дисциплинарным сетям соавторства словенских исследователей по 72 научным дисциплинам в двух временных периодах: 1991-2000 гг. и 2001-2010 гг. Изучалось, как меняется структура глобальной сети и сохраняется ли стабильность научного сотрудничества с течением времени. Целью исследования был анализ различий в стабильности и размере групп исследователей, работающих в соавторстве друг с другом (основных исследовательских групп), сформированных в дисциплинах, относящихся к естественным и техническим наукам, с одной стороны, и к социальным и гуманитарным наукам, с другой. В этом исследовании временная зависимость не учитывалась, и сети анализировались в двух временных точках.

Ядра были получены с помощью заранее специфицированной процедуры блокмоделинга, предполагающей структуру мульти-ядро - полупериферия - периферия. Устойчивость полученных ядер измерялась с помощью модифицированного скорректированного индекса Рэнда.

Предполагаемая структура мульти-ядро - полупериферия - периферия подтвердилась во всех анализируемых дисциплинах. Средний размер полученных ядер выше во втором временном периоде, причем средний размер ядра больше в естественных и технических науках, чем в социальных и гуманитарных. Различий в средней стабильности ядра между естественными и техническими науками и социальными и гуманитарными науками не наблюдается. Однако если стабильность ядер определяется по разделению ядер, а не по доле исследователей, покинувших ядра, то при контроле характеристик сетей и дисциплин средняя стабильность ядер выше в дисциплинах из научных областей "Инженерные науки и технологии" и "Медицинские науки", чем в дисциплинах гуманитарных наук.

В 2020 году были получены новые данные и результаты, продлевающие исследование еще на десять лет. Это позволяет проанализировать три временные точки, каждая из которых охватывает десятилетний период. Вопросы исследования касаются эффектов применения процедуры блокмоделинга с учетом временной зависимости и устойчивости полученной структуры. Поэтому в рамках имитационного исследования методом Монте-Карло было проведено сравнение подходов к анализу динамического блокмоделинга, в соответствии с которым были выбраны наиболее эффективные и безопасные для использования подходы.

В будущем эти подходы к блокмоделингу должны быть применены и оценены на реальных сетях соавторства, учитывая значительные знания о сетях сотрудничества в случае словенских исследователей.

### Выводы
В данном разделе проводится систематизации различных подходов в области блокмоделинга и  их сравнительный анализ для оценки эффективности применения при анализе динамических сетей. В качестве примера взяты сети соавторства, изменяющиеся во времени.

После рассмотрения общих особенностей применения методологии блокмоделинга и проблематики изучения динамических сетей рассматриваются особенности использования методологии блокмоделинга для анализа динамических сетей. Поскольку одной из основных особенностей анализа динамических сетей является проверка их устойчивости, рассматриваются также основные сведения о подходах к оценке устойчивости структуры блокмоделей на основе Рэнд-индекса. В работе рассматривается два подхода к блокмоделингу – детерминированный и стохастический, - и приводится разбор разработанных на основе этих подходов моделей, в т.ч. тех, которые применяются для анализа динамических сетей.  На основе работы Цугмаса и Жиберны, в обзоре приведены основные результаты сравнения моделей с помощью имитационного моделирования методом Монте-Карло (метод симуляции), в т.ч. модели для исследования ненаправленных сетей в динамике. В завершение анализируется использование блокмоделинга для изучения ненаправленных сетей соавторства во времени в различных научных дисциплинах.

Подводя итог, можно сказать, что лучшими подходами к блокмоделингу, исходя из полученных результатов, являются:

* Динамический стохастический блокмоделинг - DSBM [@matias2017]
* Стохастический блокмоделинг для анализа многоуровневых сетей - SBMfML [@chabert-liddell]
* Стохастический блокмоделинг для многосторонних сетей - SBMfMPN [@bar-hen2022]

Динамический стохастический блокмоделинг используется для стабильных сетевых структур. В противном случае используется стохастический блокмоделинг для многоуровневых сетей, когда нет приходящих и уходящих узлов. При наличии входящих и уходящих узлов нужно рассматривать стохастический блокмоделинг для многосторонних сетей.

Эти рекомендации призваны упростить процесс принятия решений. Хотя в конкретных случаях они не всегда дают абсолютно оптимальные результаты, эти подходы минимизируют риск получения ошибочных или недостоверных результатов. При анализе реальных сетей часто бывает сложно определить, полностью ли выполняются все исходные предположения различных подходов. Поэтому выбор в пользу более безопасных подходов обеспечивает определенный уровень уверенности в результатах анализа.
